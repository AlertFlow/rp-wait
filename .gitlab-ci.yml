stages:
  - release

# if the commit is tagged with a version number and the branch is main, then release the version
release-version-job:
  stage: release
  image: registry.gitlab.com/gitlab-org/release-cli:latest
  rules:
    - if: $CI_COMMIT_TAG =~ /^v[0-9]+\.[0-9]+\.[0-9]+/
  script:
    - echo "Releasing version $CI_COMMIT_TAG"
  release:
    tag_name: $CI_COMMIT_TAG
    description: "Release $CI_COMMIT_TAG"
    name: $CI_COMMIT_TAG
    ref: $CI_COMMIT_REF_NAME
